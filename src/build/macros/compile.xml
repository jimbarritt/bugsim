<?xml version="1.0" encoding="ISO-8859-1"?>
<project name="compile">

    <macrodef name="copy-resources">
        <attribute name="src.dir"/>
        <attribute name="dest.dir"/>
        <sequential>
            <echo message="copying resources from java source dir..." />
            <copy todir="@{dest.dir}">
                <fileset dir="@{src.dir}">
                    <exclude name="**/*.java" />
                </fileset>
            </copy>
        </sequential>
    </macrodef>

    <macrodef name="compile-java">
        <attribute name="configuration" default="main"/>
        <attribute name="classpath.refid"/>
        <attribute name="src.dir"/>
        <attribute name="target.classes.dir"/>

        <attribute name="java.version" default="1.5"/>
        <attribute name="debug" default="true"/>
        <attribute name="hide.warnings" default="true"/>
        <attribute name="print.classpath" default="true"/>


        <sequential>
            <property name="print.classpath" value="@{print.classpath}" />
            <echo message="Compiling classes for configuration [@{configuration}]"/>
            <echo message="src.dir            : @{src.dir}"/>
            <echo message="target.classes.dir : @{target.classes.dir}"/>
            <echo message="java.version       : @{java.version}"/>
            <echo message="classpath.refid    : @{classpath.refid}"/>

            <echo-classpath path.refid="@{classpath.refid}"/>

            <echo message="" />
            <mkdir dir="@{target.classes.dir}" />
            
            <javac srcdir="@{src.dir}"
                   target="@{java.version}"
                   source="@{java.version}"
                   debug="@{debug}"
                   nowarn="@{hide.warnings}"
                   destdir="@{target.classes.dir}">
                <classpath refid="@{classpath.refid}"/>
            </javac>

            <copy-resources src.dir="@{src.dir}"
                            dest.dir="@{target.classes.dir}" />
        </sequential>
    </macrodef>

</project>